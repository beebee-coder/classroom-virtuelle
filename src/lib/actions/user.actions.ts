// src/lib/actions/user.actions.ts
"use server";

import { revalidatePath } from "next/cache";
import { getAuthSession } from "@/lib/session";

// ---=== BYPASS BACKEND ===---
export async function updateUserProfileImage(imageUrl: string) {
  const session = await getAuthSession();
  const userId = session?.user?.id;

  if (!userId) {
    console.warn("üë§ [BYPASS] Tentative de mise √† jour d'image sans session. Action ignor√©e.");
    throw new Error("Unauthorized (Bypassed)");
  }

  console.log(`üñºÔ∏è [BYPASS] Mise √† jour de l'image de profil pour l'utilisateur ${userId} avec l'URL: ${imageUrl} (factice)`);

  try {
    // En mode bypass, nous ne mettons pas √† jour la base de donn√©es.
    console.log("   -> L'appel √† la base de donn√©es a √©t√© saut√©.");

    // Revalidate paths where the user's avatar might be displayed
    revalidatePath('/', 'layout');
    
  } catch (error) {
    console.error("‚ùå Erreur (simul√©e) lors de la mise √† jour de l'image de profil:", error);
    throw new Error("Failed to update profile image (Bypassed).");
  }
}
// ---=========================---
