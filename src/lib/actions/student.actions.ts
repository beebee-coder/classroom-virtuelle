// src/lib/actions/student.actions.ts
'use server';

import { revalidatePath } from 'next/cache';
import { pusherServer } from '../pusher/server';

// ---=== BYPASS BACKEND ===---
export async function setStudentCareer(studentId: string, careerId: string | null) {
    console.log(`üé® [BYPASS] Changement de m√©tier (factice) pour l'√©l√®ve ${studentId} vers le m√©tier ${careerId}`);

    const classroomId = 'classe-a'; // ID de classe factice pour la d√©mo
    
    console.log(`üì° [PUSHER] D√©clenchement de "student-updated" pour l'√©l√®ve ${studentId}`);
    await pusherServer.trigger(`presence-classe-${classroomId}`, 'student-updated', {
        studentId,
    });
    
    // Simule la revalidation
    revalidatePath(`/student/${studentId}`);
    revalidatePath(`/student/dashboard`);
}
// ---=========================---
